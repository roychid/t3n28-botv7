<!DOCTYPE html>
<html>
<head>
  <title>t3n28-bot - European Sports Betting Analysis</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: Arial; background:#0a0a0a; color:#fff; padding:20px; }
    .container { max-width:1400px; margin:0 auto; }
    header { text-align:center; margin-bottom:30px; padding-bottom:20px; border-bottom:2px solid #00ff00; }
    h1 { font-size:28px; color:#00ff00; margin-bottom:5px; }
    .subtitle { color:#888; font-size:14px; }
    
    /* Sport Tabs */
    .sport-tabs { display:flex; gap:10px; margin-bottom:20px; }
    .sport-tab { padding:10px 20px; background:#1a1a1a; border:1px solid #333; border-radius:4px; cursor:pointer; }
    .sport-tab.active { background:#00ff00; color:#000; border-color:#00ff00; }
    .sport-tab:hover { background:#333; }
    
    .controls { background:#1a1a1a; padding:20px; border-radius:8px; margin-bottom:30px; border:1px solid #333; }
    .control-row { display:flex; gap:10px; flex-wrap:wrap; margin-bottom:10px; }
    .filter-group { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    input, select { padding:10px; background:#0a0a0a; border:1px solid #00ff00; color:#fff; border-radius:4px; font-size:14px; }
    input:focus, select:focus { outline:none; border-color:#00ff00; box-shadow:0 0 5px rgba(0,255,0,0.3); }
    button { padding:10px 20px; background:#00ff00; color:#000; border:none; border-radius:4px; font-weight:bold; cursor:pointer; font-size:14px; }
    button:hover { background:#00cc00; }
    button:active { background:#009900; }
    .btn-secondary { background:#333; color:#00ff00; border:1px solid #00ff00; }
    .btn-secondary:hover { background:#444; }
    .btn-small { padding:5px 10px; font-size:12px; }
    
    /* Bet Slip */
    .bet-slip-container { position:fixed; right:20px; top:20px; width:350px; background:#1a1a1a; border:2px solid #00ff00; border-radius:8px; padding:15px; z-index:1000; max-height:80vh; overflow-y:auto; display:none; }
    .bet-slip-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:15px; padding-bottom:10px; border-bottom:1px solid #333; }
    .bet-slip-title { color:#00ff00; font-weight:bold; }
    .bet-slip-close { color:#ff4444; cursor:pointer; font-size:20px; }
    .bet-slip-item { background:#0a0a0a; padding:10px; margin-bottom:10px; border-radius:4px; border:1px solid #333; }
    .bet-slip-item-header { display:flex; justify-content:space-between; margin-bottom:5px; }
    .bet-slip-item-remove { color:#ff4444; cursor:pointer; font-size:12px; }
    .bet-slip-total { margin-top:15px; padding-top:10px; border-top:1px solid #333; text-align:right; font-weight:bold; }
    .bet-slip-actions { display:flex; gap:10px; margin-top:15px; }
    
    /* Match Selection */
    .match-selection-controls { background:#111; padding:15px; border-radius:6px; margin-bottom:20px; }
    .selection-count { display:inline-block; background:#00ff00; color:#000; padding:5px 10px; border-radius:4px; margin-left:10px; font-weight:bold; }
    
    .games-list { display:grid; gap:20px; }
    .game-card { background:#1a1a1a; border:2px solid #333; border-radius:8px; padding:20px; transition:all 0.3s; }
    .game-card.selected { border-color:#00ff00; background:rgba(0,255,0,0.05); }
    .game-card.soccer { border-left:4px solid #00ff00; }
    .game-card.basketball { border-left:4px solid #ff8800; }
    
    .game-header { display:flex; justify-content:space-between; margin-bottom:20px; padding-bottom:10px; border-bottom:1px solid #333; }
    .league { color:#00ff00; font-size:12px; font-weight:bold; }
    .time { color:#888; font-size:12px; }
    .sport-badge { display:inline-block; padding:2px 8px; border-radius:10px; font-size:10px; font-weight:bold; margin-right:5px; }
    .soccer-badge { background:#00ff00; color:#000; }
    .basketball-badge { background:#ff8800; color:#000; }
    
    .teams { display:grid; grid-template-columns:1fr auto 1fr; gap:20px; margin-bottom:20px; align-items:center; }
    .team { text-align:center; }
    .team-name { font-size:18px; font-weight:bold; margin-bottom:10px; }
    .team-logo { height:40px; margin-bottom:10px; }
    .form { display:flex; gap:5px; justify-content:center; }
    .form-box { width:22px; height:22px; display:flex; align-items:center; justify-content:center; font-size:11px; font-weight:bold; border-radius:3px; }
    .W { background:#00ff00; color:#000; }
    .D { background:#666; color:#fff; }
    .L { background:#ff0000; color:#fff; }
    .vs { font-size:18px; color:#666; font-weight:bold; text-align:center; }
    
    /* Odds Section */
    .odds-section { margin:20px 0; }
    .odds-title { color:#00ff00; font-size:14px; margin-bottom:10px; }
    .odds-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(100px, 1fr)); gap:10px; }
    .odd-box { background:#0a0a0a; padding:15px; border-radius:4px; border:1px solid #333; text-align:center; cursor:pointer; transition:all 0.2s; }
    .odd-box:hover { border-color:#00ff00; background:#111; }
    .odd-box.selected { background:#00ff00; color:#000; border-color:#00ff00; }
    .odd-label { font-size:11px; color:#888; margin-bottom:5px; }
    .odd-value { font-size:18px; font-weight:bold; }
    .odd-probability { font-size:10px; color:#666; margin-top:3px; }
    
    .stats { display:grid; grid-template-columns:repeat(auto-fit, minmax(150px,1fr)); gap:15px; margin-bottom:20px; }
    .stat { background:#0a0a0a; padding:12px; border-radius:4px; border:1px solid #333; }
    .stat-label { font-size:11px; color:#888; margin-bottom:5px; text-transform:uppercase; }
    .stat-value { display:flex; justify-content:space-between; font-size:16px; font-weight:bold; }
    .stat-home { color:#00ff00; }
    .stat-away { color:#fff; }
    
    .advice { background:#0a0a0a; padding:15px; border-radius:4px; border-left:3px solid #00ff00; }
    .advice-title { color:#00ff00; font-size:14px; font-weight:bold; margin-bottom:10px; }
    .advice-text { color:#ccc; font-size:13px; line-height:1.6; margin-bottom:10px; }
    .recommendation { display:inline-block; background:#00ff00; color:#000; padding:8px 15px; border-radius:4px; font-weight:bold; font-size:13px; margin-right:10px; }
    .confidence { color:#888; font-size:12px; }
    
    .loading, .no-games { text-align:center; padding:40px; color:#888; }
    .no-games { background:#1a1a1a; border-radius:8px; border:1px solid #333; }
    
    /* Multi-match combos */
    .combos-section { background:#111; padding:20px; border-radius:8px; margin-top:30px; border:1px solid #333; }
    .combo-grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(300px, 1fr)); gap:15px; margin-top:15px; }
    .combo-card { background:#1a1a1a; padding:15px; border-radius:6px; border:1px solid #333; }
    .combo-matches { font-size:12px; color:#888; margin-bottom:10px; }
    .combo-odds { font-size:20px; font-weight:bold; color:#00ff00; }
    .combo-stake { margin-top:10px; display:flex; gap:10px; }
    .combo-stake input { flex:1; }
    
    /* Loading animation */
    .loading { text-align: center; padding: 60px 20px; color: #00ff00; font-size: 16px; }
    .loading:after { content: ''; display: inline-block; width: 20px; height: 20px; border: 2px solid #00ff00; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite; margin-left: 10px; vertical-align: middle; }
    @keyframes spin { to { transform: rotate(360deg); } }
    
    .probability-bar { display: flex; height: 6px; background: #333; border-radius: 3px; margin: 10px 0; overflow: hidden; }
    .probability-home { background: #00ff00; }
    .probability-draw { background: #666; }
    .probability-away { background: #fff; }
    
    .insight-badge { display: inline-block; background: rgba(0, 255, 0, 0.1); color: #00ff00; padding: 3px 8px; border-radius: 10px; font-size: 10px; margin: 2px; }
    .select-match-btn { margin-top:15px; padding:8px 15px; width:100%; background:#333; color:#00ff00; border:1px solid #00ff00; border-radius:4px; cursor:pointer; }
    .select-match-btn.selected { background:#00ff00; color:#000; }
    .select-match-btn:hover { background:#444; }
    
    /* League Groups */
    .league-group { margin-bottom:30px; }
    .league-group-header { background:#111; padding:10px 15px; border-radius:6px; margin-bottom:15px; border-left:4px solid #00ff00; }
    
    /* Basketball specific */
    .basketball-stat { grid-template-columns:repeat(auto-fit, minmax(120px,1fr)); }
    .quarter-scores { display:flex; gap:10px; justify-content:center; margin:10px 0; }
    .quarter-score { background:#0a0a0a; padding:5px 10px; border-radius:4px; font-size:11px; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>‚öΩüèÄ EUROPEAN SPORTS BETTING ANALYSIS</h1>
      <p class="subtitle">AI-Powered Predictions with Real Odds & Historical Data</p>
    </header>

    <!-- Sport Selection Tabs -->
    <div class="sport-tabs">
      <div class="sport-tab active" onclick="switchSport('soccer')">‚öΩ Soccer</div>
      <div class="sport-tab" onclick="switchSport('basketball')">üèÄ Basketball</div>
      <div class="sport-tab" onclick="switchSport('both')">‚öΩüèÄ Both</div>
    </div>

    <!-- Bet Slip -->
    <div class="bet-slip-container" id="betSlip">
      <div class="bet-slip-header">
        <div class="bet-slip-title">üéØ BET SLIP (<span id="betCount">0</span>)</div>
        <div class="bet-slip-close" onclick="toggleBetSlip()">√ó</div>
      </div>
      <div id="betSlipItems"></div>
      <div class="bet-slip-total">
        Total Odds: <span id="totalOdds">1.00</span><br>
        Potential Win: ‚Ç¨<span id="potentialWin">0.00</span>
      </div>
      <div class="bet-slip-actions">
        <input type="number" id="stakeAmount" placeholder="Stake (‚Ç¨)" min="1" value="10" style="flex:1;">
        <button onclick="placeBet()" class="btn-small">Place Bet</button>
        <button onclick="clearBetSlip()" class="btn-small btn-secondary">Clear All</button>
      </div>
    </div>

    <!-- Controls -->
    <div class="controls">
      <div class="control-row">
        <input type="date" id="dateInput" />
        <select id="leagueSelect">
          <option value="">All European Leagues</option>
          <optgroup label="Top 5 Leagues">
            <option value="39">England: Premier League</option>
            <option value="140">Spain: La Liga</option>
            <option value="78">Germany: Bundesliga</option>
            <option value="135">Italy: Serie A</option>
            <option value="61">France: Ligue 1</option>
          </optgroup>
          <optgroup label="Other European Leagues">
            <option value="94">Portugal: Primeira Liga</option>
            <option value="88">Netherlands: Eredivisie</option>
            <option value="144">Belgium: Jupiler Pro League</option>
            <option value="203">Turkey: S√ºper Lig</option>
            <option value="218">Austria: Bundesliga</option>
            <option value="119">Scotland: Premiership</option>
            <option value="253">Switzerland: Super League</option>
            <option value="106">Greece: Super League</option>
            <option value="283">Denmark: Superliga</option>
            <option value="268">Russia: Premier League</option>
            <option value="271">Ukraine: Premier League</option>
            <option value="299">Poland: Ekstraklasa</option>
            <option value="197">Czech Republic: First League</option>
            <option value="310">Romania: Liga I</option>
            <option value="332">Norway: Eliteserien</option>
            <option value="325">Sweden: Allsvenskan</option>
            <option value="319">Finland: Veikkausliiga</option>
            <option value="433">Hungary: NB I</option>
            <option value="445">Croatia: HNL</option>
            <option value="103">Serbia: SuperLiga</option>
            <option value="498">Slovakia: Fortuna Liga</option>
            <option value="529">Slovenia: PrvaLiga</option>
          </optgroup>
          <optgroup label="European Competitions">
            <option value="2">UEFA Champions League</option>
            <option value="3">UEFA Europa League</option>
            <option value="848">UEFA Conference League</option>
            <option value="143">Euro Championship</option>
          </optgroup>
        </select>
        <select id="countrySelect">
          <option value="">All Countries</option>
          <option value="England">England</option>
          <option value="Spain">Spain</option>
          <option value="Germany">Germany</option>
          <option value="Italy">Italy</option>
          <option value="France">France</option>
          <option value="Portugal">Portugal</option>
          <option value="Netherlands">Netherlands</option>
          <option value="Turkey">Turkey</option>
          <option value="Russia">Russia</option>
          <option value="Ukraine">Ukraine</option>
        </select>
        <button onclick="loadGames()">LOAD GAMES</button>
        <button onclick="toggleBetSlip()" class="btn-secondary" id="betSlipBtn">üìã Bet Slip (0)</button>
      </div>
      
      <!-- Multi-match Controls -->
      <div class="match-selection-controls">
        <strong>üéØ MULTI-MATCH BETTING:</strong> 
        <span id="selectedCount" class="selection-count">0 matches selected</span>
        
        <div style="display:flex; gap:15px; margin-top:10px; flex-wrap:wrap;">
          <div class="filter-group">
            <label style="color:#888;">Stake per combo:</label>
            <input type="number" id="comboStake" value="5" min="1" max="1000" style="width:80px;">
          </div>
          <button onclick="generateCombos(2)" class="btn-small">Generate 2-Match Combos</button>
          <button onclick="generateCombos(3)" class="btn-small">Generate 3-Match Combos</button>
          <button onclick="generateCombos(4)" class="btn-small">Generate 4-Match Combos</button>
          <button onclick="clearSelections()" class="btn-small btn-secondary">Clear Selections</button>
        </div>
      </div>
    </div>

    <!-- Output Area -->
    <div id="output">
      <div class="loading">Loading European fixtures...</div>
    </div>

    <!-- Multi-match Combos Section -->
    <div id="combosSection" class="combos-section" style="display:none;">
      <h3>üé≤ MULTI-MATCH COMBINATIONS</h3>
      <div id="combosGrid" class="combo-grid"></div>
    </div>
    
    <footer style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #333; color: #666; font-size: 12px;">
      <p>‚ö†Ô∏è For entertainment purposes only. Always gamble responsibly.</p>
      <p>Data provided by API-Sports ‚Ä¢ European sports analysis ‚Ä¢ Times shown in your local timezone</p>
    </footer>
  </div>

  <script>
    // Configuration
    const currentSport = 'soccer';
    const selectedMatches = new Map(); // Map of match_id -> {match, selection}
    const betSlip = new Map(); // Map of match_id -> {match, selection, odds}
    
    // European Soccer Leagues (API-Football IDs)
    const EUROPEAN_SOCCER_LEAGUES = [
      39, 140, 78, 135, 61, 94, 88, 144, 203, 218, 119, 253, 106, 283, 268, 
      271, 299, 197, 310, 332, 325, 319, 433, 445, 103, 498, 529, 2, 3, 848, 143
    ];
    
    // European Basketball Leagues (API-Basketball IDs)
    const EUROPEAN_BASKETBALL_LEAGUES = [
      12,    // NBA (includes European players/international)
      117,   // Euroleague
      120,   // Eurocup
      38,    // Spain: ACB
      94,    // Turkey: BSL
      48,    // Germany: BBL
      45,    // France: LNB Pro A
      50,    // Italy: Lega Serie A
      87,    // Greece: Basket League
      65,    // Russia: VTB United League
      62,    // Lithuania: LKL
      66,    // Adriatic: ABA League
      72,    // Poland: PLK
      71     // Israel: Winner League
    ];
    
    document.getElementById('dateInput').valueAsDate = new Date();
    
    // Switch between sports
    function switchSport(sport) {
      document.querySelectorAll('.sport-tab').forEach(tab => tab.classList.remove('active'));
      event.target.classList.add('active');
      
      if (sport === 'soccer') {
        document.getElementById('leagueSelect').innerHTML = `
          <option value="">All European Soccer Leagues</option>
          <optgroup label="Top 5 Leagues">
            <option value="39">England: Premier League</option>
            <option value="140">Spain: La Liga</option>
            <option value="78">Germany: Bundesliga</option>
            <option value="135">Italy: Serie A</option>
            <option value="61">France: Ligue 1</option>
          </optgroup>
          <optgroup label="Other European Leagues">
            <option value="94">Portugal: Primeira Liga</option>
            <option value="88">Netherlands: Eredivisie</option>
            <option value="144">Belgium: Jupiler Pro League</option>
            <option value="203">Turkey: S√ºper Lig</option>
            <option value="218">Austria: Bundesliga</option>
            <option value="119">Scotland: Premiership</option>
            <option value="253">Switzerland: Super League</option>
            <option value="106">Greece: Super League</option>
            <option value="283">Denmark: Superliga</option>
            <option value="268">Russia: Premier League</option>
            <option value="271">Ukraine: Premier League</option>
            <option value="299">Poland: Ekstraklasa</option>
            <option value="197">Czech Republic: First League</option>
            <option value="310">Romania: Liga I</option>
            <option value="332">Norway: Eliteserien</option>
            <option value="325">Sweden: Allsvenskan</option>
            <option value="319">Finland: Veikkausliiga</option>
            <option value="433">Hungary: NB I</option>
            <option value="445">Croatia: HNL</option>
            <option value="103">Serbia: SuperLiga</option>
            <option value="498">Slovakia: Fortuna Liga</option>
            <option value="529">Slovenia: PrvaLiga</option>
          </optgroup>
          <optgroup label="European Competitions">
            <option value="2">UEFA Champions League</option>
            <option value="3">UEFA Europa League</option>
            <option value="848">UEFA Conference League</option>
            <option value="143">Euro Championship</option>
          </optgroup>
        `;
        loadGames();
      } else if (sport === 'basketball') {
        document.getElementById('leagueSelect').innerHTML = `
          <option value="">All European Basketball Leagues</option>
          <optgroup label="Top European Competitions">
            <option value="117">Euroleague</option>
            <option value="120">Eurocup</option>
            <option value="12">NBA (International)</option>
          </optgroup>
          <optgroup label="Domestic Leagues">
            <option value="38">Spain: ACB</option>
            <option value="94">Turkey: BSL</option>
            <option value="48">Germany: BBL</option>
            <option value="45">France: LNB Pro A</option>
            <option value="50">Italy: Lega Serie A</option>
            <option value="87">Greece: Basket League</option>
            <option value="65">Russia: VTB United League</option>
            <option value="62">Lithuania: LKL</option>
            <option value="66">Adriatic: ABA League</option>
            <option value="72">Poland: PLK</option>
            <option value="71">Israel: Winner League</option>
          </optgroup>
        `;
        loadGames();
      } else {
        // Both sports
        document.getElementById('leagueSelect').innerHTML = `
          <option value="">All European Sports</option>
          <optgroup label="‚öΩ Soccer Top Leagues">
            <option value="soccer_39">England: Premier League</option>
            <option value="soccer_140">Spain: La Liga</option>
            <option value="soccer_78">Germany: Bundesliga</option>
            <option value="soccer_135">Italy: Serie A</option>
          </optgroup>
          <optgroup label="üèÄ Basketball Top Leagues">
            <option value="basketball_117">Euroleague</option>
            <option value="basketball_38">Spain: ACB</option>
            <option value="basketball_94">Turkey: BSL</option>
          </optgroup>
        `;
        loadGames();
      }
    }
    
    // Format time in local timezone
    function formatTime(dateString) {
      if (!dateString) return "TBD";
      const date = new Date(dateString);
      return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    }
    
    // Get current time in C.A. (Central Africa Time = GMT+2)
    function getCATime() {
      return new Date().toLocaleString("en-US", {
        timeZone: "Africa/Cairo",
        hour12: false,
        hour: '2-digit',
        minute: '2-digit'
      });
    }
    
    // Toggle match selection
    function toggleMatchSelection(matchId, selectionType, odds) {
      const match = selectedMatches.get(matchId);
      if (!match) return;
      
      const key = `${matchId}_${selectionType}`;
      
      if (betSlip.has(key)) {
        betSlip.delete(key);
      } else {
        betSlip.set(key, {
          match: match,
          selection: selectionType,
          odds: odds
        });
      }
      
      updateBetSlip();
      updateSelectionCount();
    }
    
    // Update bet slip UI
    function updateBetSlip() {
      const betSlipItems = document.getElementById('betSlipItems');
      let totalOdds = 1;
      
      if (betSlip.size === 0) {
        betSlipItems.innerHTML = '<div style="text-align:center;color:#888;padding:20px;">No bets selected</div>';
      } else {
        let html = '';
        betSlip.forEach((bet, key) => {
          const match = bet.match;
          totalOdds *= parseFloat(bet.odds);
          
          html += `
            <div class="bet-slip-item">
              <div class="bet-slip-item-header">
                <div>${match.teams.home.name} vs ${match.teams.away.name}</div>
                <div class="bet-slip-item-remove" onclick="removeFromBetSlip('${key}')">√ó</div>
              </div>
              <div style="font-size:12px;color:#888;">${bet.selection} @ ${bet.odds}</div>
              <div style="font-size:11px;color:#666;">${match.league.name}</div>
            </div>
          `;
        });
        betSlipItems.innerHTML = html;
      }
      
      document.getElementById('betCount').textContent = betSlip.size;
      document.getElementById('totalOdds').textContent = totalOdds.toFixed(2);
      document.getElementById('betSlipBtn').textContent = `üìã Bet Slip (${betSlip.size})`;
      
      updatePotentialWin();
    }
    
    // Update potential win
    function updatePotentialWin() {
      const stake = parseFloat(document.getElementById('stakeAmount').value) || 0;
      const totalOdds = parseFloat(document.getElementById('totalOdds').textContent) || 1;
      const potentialWin = stake * totalOdds;
      document.getElementById('potentialWin').textContent = potentialWin.toFixed(2);
    }
    
    // Remove from bet slip
    function removeFromBetSlip(key) {
      betSlip.delete(key);
      updateBetSlip();
      updateSelectionCount();
    }
    
    // Clear bet slip
    function clearBetSlip() {
      betSlip.clear();
      updateBetSlip();
      updateSelectionCount();
    }
    
    // Toggle bet slip visibility
    function toggleBetSlip() {
      const slip = document.getElementById('betSlip');
      slip.style.display = slip.style.display === 'none' ? 'block' : 'none';
    }
    
    // Place bet
    function placeBet() {
      if (betSlip.size === 0) {
        alert('No bets selected!');
        return;
      }
      
      const stake = parseFloat(document.getElementById('stakeAmount').value);
      if (!stake || stake < 1) {
        alert('Please enter a valid stake amount (min ‚Ç¨1)');
        return;
      }
      
      const totalOdds = parseFloat(document.getElementById('totalOdds').textContent);
      const potentialWin = stake * totalOdds;
      
      // Save to localStorage for record keeping
      const betRecord = {
        id: Date.now(),
        date: new Date().toISOString(),
        matches: Array.from(betSlip.values()),
        stake: stake,
        totalOdds: totalOdds,
        potentialWin: potentialWin,
        status: 'pending'
      };
      
      let betHistory = JSON.parse(localStorage.getItem('betHistory') || '[]');
      betHistory.push(betRecord);
      localStorage.setItem('betHistory', JSON.stringify(betHistory));
      
      alert(`‚úÖ Bet placed!\nStake: ‚Ç¨${stake}\nTotal Odds: ${totalOdds.toFixed(2)}\nPotential Win: ‚Ç¨${potentialWin.toFixed(2)}`);
      
      // Clear bet slip after placing
      clearBetSlip();
    }
    
    // Update selection count
    function updateSelectionCount() {
      document.getElementById('selectedCount').textContent = `${betSlip.size} matches selected`;
    }
    
    // Clear all selections
    function clearSelections() {
      selectedMatches.clear();
      clearBetSlip();
      document.querySelectorAll('.game-card').forEach(card => {
        card.classList.remove('selected');
      });
      document.querySelectorAll('.odd-box').forEach(box => {
        box.classList.remove('selected');
      });
      updateSelectionCount();
    }
    
    // Generate match combinations
    function generateCombos(matchCount) {
      if (betSlip.size < matchCount) {
        alert(`Please select at least ${matchCount} matches first!`);
        return;
      }
      
      const combos = [];
      const bets = Array.from(betSlip.values());
      
      // Generate all combinations (simplified for demo)
      if (bets.length <= 6) { // Limit for performance
        // Simple combination: first N matches
        for (let i = 0; i <= bets.length - matchCount; i++) {
          const combo = bets.slice(i, i + matchCount);
          const comboOdds = combo.reduce((acc, bet) => acc * parseFloat(bet.odds), 1);
          
          combos.push({
            matches: combo,
            odds: comboOdds.toFixed(2)
          });
        }
      }
      
      displayCombos(combos);
    }
    
    // Display combos
    function displayCombos(combos) {
      const section = document.getElementById('combosSection');
      const grid = document.getElementById('combosGrid');
      
      if (combos.length === 0) {
        grid.innerHTML = '<div style="text-align:center;color:#888;padding:20px;">No combinations available</div>';
        section.style.display = 'block';
        return;
      }
      
      let html = '';
      const stake = parseFloat(document.getElementById('comboStake').value) || 5;
      
      combos.forEach((combo, index) => {
        const potentialWin = stake * parseFloat(combo.odds);
        
        html += `
          <div class="combo-card">
            <div class="combo-matches">
              ${combo.matches.map(bet => 
                `${bet.match.teams.home.abbr || bet.match.teams.home.name.slice(0,3)} vs ${bet.match.teams.away.abbr || bet.match.teams.away.name.slice(0,3)}: ${bet.selection}`
              ).join('<br>')}
            </div>
            <div class="combo-odds">Total Odds: ${combo.odds}</div>
            <div style="font-size:12px;color:#888;">Potential Win: ‚Ç¨${potentialWin.toFixed(2)}</div>
            <div class="combo-stake">
              <input type="number" value="${stake}" min="1" max="1000" onchange="updateComboWin(${index}, this.value)">
              <button onclick="addComboToBetSlip(${index})" class="btn-small">Add to Bet Slip</button>
            </div>
          </div>
        `;
      });
      
      grid.innerHTML = html;
      section.style.display = 'block';
    }
    
    // Main function to load games
    async function loadGames() {
      const output = document.getElementById('output');
      output.innerHTML = '<div class="loading">üîÑ Loading European fixtures...</div>';
      
      const selectedLeague = document.getElementById('leagueSelect').value;
      const date = document.getElementById('dateInput').value;
      const country = document.getElementById('countrySelect').value;
      
      // Get current sport from active tab
      const sport = document.querySelector('.sport-tab.active').textContent;
      
      try {
        const params = new URLSearchParams({ 
          date,
          sport: sport.includes('‚öΩ') ? 'soccer' : sport.includes('üèÄ') ? 'basketball' : 'both'
        });
        
        if (selectedLeague) {
          if (selectedLeague.includes('soccer_')) {
            params.append('league', selectedLeague.replace('soccer_', ''));
            params.append('sport', 'soccer');
          } else if (selectedLeague.includes('basketball_')) {
            params.append('league', selectedLeague.replace('basketball_', ''));
            params.append('sport', 'basketball');
          } else {
            params.append('league', selectedLeague);
          }
        }
        
        if (country) {
          params.append('country', country);
        }
        
        const res = await fetch(`/api/fixtures?${params}`);
        
        if (!res.ok) {
          throw new Error(`API returned ${res.status}`);
        }
        
        const data = await res.json();
        let fixtures = data.fixtures || [];
        
        // Group by league/country
        const groupedFixtures = groupFixturesByLeague(fixtures);
        
        if (fixtures.length === 0) {
          output.innerHTML = `
            <div class="no-games">
              <h3>No European Fixtures Found</h3>
              <p>No ${sport} matches scheduled for ${date}${selectedLeague ? ' in selected league' : ''}.</p>
              <p>Try a different date or select another league.</p>
              <div style="margin-top:20px;color:#00ff00;">Current C.A. Time: ${getCATime()}</div>
            </div>
          `;
          return;
        }
        
        displayFixtures(groupedFixtures, sport);
        
      } catch (err) {
        console.error('Error loading games:', err);
        output.innerHTML = `
          <div class="no-games">
            <h3>‚ö†Ô∏è Connection Error</h3>
            <p>Failed to fetch data from API.</p>
            <button onclick="loadGames()" style="margin-top:15px;">
              üîÑ Retry Connection
            </button>
          </div>
        `;
      }
    }
    
    // Group fixtures by league/country
    function groupFixturesByLeague(fixtures) {
      const groups = {};
      
      fixtures.forEach(fixture => {
        const key = fixture.league.country || fixture.league.name;
        if (!groups[key]) {
          groups[key] = [];
        }
        groups[key].push(fixture);
      });
      
      return groups;
    }
    
    // Display fixtures
    function displayFixtures(groupedFixtures, sport) {
      const output = document.getElementById('output');
      let html = `<div style="color:#888;margin-bottom:20px;text-align:center;">
        ‚è∞ Current C.A. Time: ${getCATime()} | Showing ${Object.keys(groupedFixtures).length} league groups
      </div>`;
      
      for (const [groupName, fixtures] of Object.entries(groupedFixtures)) {
        html += `<div class="league-group">
          <div class="league-group-header">
            <strong>${groupName}</strong> <span style="color:#888;font-size:12px;">(${fixtures.length} matches)</span>
          </div>
          <div class="games-list">`;
        
        fixtures.forEach(fixture => {
          const isSoccer = fixture.sport === 'soccer' || !fixture.sport;
          html += renderGameCard(fixture, isSoccer);
          selectedMatches.set(fixture.id, fixture);
        });
        
        html += `</div></div>`;
      }
      
      output.innerHTML = html;
    }
    
    // Render game card
    function renderGameCard(game, isSoccer = true) {
      const analysis = game.analysis || getDefaultAnalysis(game);
      const homeStats = game.stats?.home || getDefaultStats();
      const awayStats = game.stats?.away || getDefaultStats();
      const homeForm = game.form?.home || ['-', '-', '-', '-', '-'];
      const awayForm = game.form?.away || ['-', '-', '-', '-', '-'];
      
      // Get odds from bookmakers
      const odds = game.odds?.bookmakers?.[0]?.bets?.[0]?.values || [
        { value: "Home", odd: "1.85" },
        { value: "Draw", odd: "3.50" },
        { value: "Away", odd: "4.20" }
      ];
      
      const sportClass = isSoccer ? 'soccer' : 'basketball';
      const sportBadge = isSoccer ? 
        '<span class="sport-badge soccer-badge">‚öΩ</span>' : 
        '<span class="sport-badge basketball-badge">üèÄ</span>';
      
      return `
        <div class="game-card ${sportClass}" id="game-${game.id}">
          <div class="game-header">
            <div class="league">
              ${sportBadge} ${game.league.country ? `${game.league.country}: ` : ''}${game.league.name}
            </div>
            <div class="time">${formatTime(game.fixture.date)}</div>
          </div>
          
          <div class="teams">
            <div class="team">
              ${game.teams.home.logo ? `<img src="${game.teams.home.logo}" class="team-logo">` : ''}
              <div class="team-name">${game.teams.home.name}</div>
              <div class="form">
                ${homeForm.map(result => `<span class="form-box ${getFormClass(result)}">${result}</span>`).join('')}
              </div>
            </div>
            
            <div class="vs">VS<br><span style="font-size:12px;color:#888;">${formatTime(game.fixture.date)}</span></div>
            
            <div class="team">
              ${game.teams.away.logo ? `<img src="${game.teams.away.logo}" class="team-logo">` : ''}
              <div class="team-name">${game.teams.away.name}</div>
              <div class="form">
                ${awayForm.map(result => `<span class="form-box ${getFormClass(result)}">${result}</span>`).join('')}
              </div>
            </div>
          </div>
          
          ${isSoccer ? renderSoccerOdds(game, odds) : renderBasketballOdds(game, odds)}
          
          ${isSoccer ? renderSoccerStats(homeStats, awayStats) : renderBasketballStats(game)}
          
          <div class="advice">
            <div class="advice-title">üìä AI PREDICTION ANALYSIS</div>
            <div class="advice-text">${analysis.advice}</div>
            <div style="display: flex; align-items: center; margin-top: 15px;">
              <span class="recommendation">${analysis.recommendation}</span>
              <span class="confidence" style="color: ${getConfidenceColor(analysis.confidence)}">
                Confidence: ${analysis.confidence}%
              </span>
            </div>
          </div>
        </div>
      `;
    }
    
    // Render soccer odds
    function renderSoccerOdds(game, odds) {
      const matchId = game.id;
      return `
        <div class="odds-section">
          <div class="odds-title">üéØ BETTING ODDS</div>
          <div class="odds-grid">
            ${odds.map(odd => `
              <div class="odd-box" onclick="toggleMatchSelection('${matchId}', '${odd.value}', '${odd.odd}')"
                   id="odd-${matchId}-${odd.value}">
                <div class="odd-label">${odd.value}</div>
                <div class="odd-value">${odd.odd}</div>
                <div class="odd-probability">${calculateProbability(odd.odd)}%</div>
              </div>
            `).join('')}
          </div>
          ${game.odds?.bookmakers?.[0]?.name ? 
            `<div style="font-size:10px;color:#666;text-align:center;margin-top:5px;">
              Odds from: ${game.odds.bookmakers[0].name}
            </div>` : ''}
        </div>
      `;
    }
    
    // Render basketball odds
    function renderBasketballOdds(game, odds) {
      const matchId = game.id;
      // Basketball typically has moneyline (no draw)
      const basketballOdds = [
        { value: game.teams.home.name, odd: "1.75" },
        { value: game.teams.away.name, odd: "2.10" }
      ];
      
      return `
        <div class="odds-section">
          <div class="odds-title">üéØ BETTING ODDS</div>
          <div class="odds-grid">
            ${basketballOdds.map(odd => `
              <div class="odd-box" onclick="toggleMatchSelection('${matchId}', '${odd.value}', '${odd.odd}')"
                   id="odd-${matchId}-${odd.value.replace(/\s+/g, '-')}">
                <div class="odd-label">${odd.value.length > 15 ? odd.value.substring(0,12) + '...' : odd.value}</div>
                <div class="odd-value">${odd.odd}</div>
                <div class="odd-probability">${calculateProbability(odd.odd)}%</div>
              </div>
            `).join('')}
            ${game.scores ? `
              <div class="odd-box" onclick="toggleMatchSelection('${matchId}', 'Over ${game.totalLine || 180.5}', '1.90')">
                <div class="odd-label">Over ${game.totalLine || 180.5}</div>
                <div class="odd-value">1.90</div>
              </div>
              <div class="odd-box" onclick="toggleMatchSelection('${matchId}', 'Under ${game.totalLine || 180.5}', '1.90')">
                <div class="odd-label">Under ${game.totalLine || 180.5}</div>
                <div class="odd-value">1.90</div>
              </div>
            ` : ''}
          </div>
        </div>
      `;
    }
    
    // Render soccer stats
    function renderSoccerStats(homeStats, awayStats) {
      return `
        <div class="stats">
          <div class="stat">
            <div class="stat-label">Goals/Game</div>
            <div class="stat-value">
              <span class="stat-home">${homeStats.goalsScored}</span>
              <span class="stat-away">${awayStats.goalsScored}</span>
            </div>
          </div>
          <div class="stat">
            <div class="stat-label">Conceded/Game</div>
            <div class="stat-value">
              <span class="stat-home">${homeStats.goalsConceded}</span>
              <span class="stat-away">${awayStats.goalsConceded}</span>
            </div>
          </div>
          <div class="stat">
            <div class="stat-label">Win Rate</div>
            <div class="stat-value">
              <span class="stat-home">${homeStats.winRate}%</span>
              <span class="stat-away">${awayStats.winRate}%</span>
            </div>
          </div>
          <div class="stat">
            <div class="stat-label">Clean Sheets</div>
            <div class="stat-value">
              <span class="stat-home">${homeStats.cleanSheets}%</span>
              <span class="stat-away">${awayStats.cleanSheets}%</span>
            </div>
          </div>
        </div>
      `;
    }
    
    // Render basketball stats
    function renderBasketballStats(game) {
      return `
        <div class="stats basketball-stat">
          <div class="stat">
            <div class="stat-label">Avg Points</div>
            <div class="stat-value">
              <span class="stat-home">${game.stats?.home?.ppg || 'N/A'}</span>
              <span class="stat-away">${game.stats?.away?.ppg || 'N/A'}</span>
            </div>
          </div>
          <div class="stat">
            <div class="stat-label">Avg Allowed</div>
            <div class="stat-value">
              <span class="stat-home">${game.stats?.home?.papg || 'N/A'}</span>
              <span class="stat-away">${game.stats?.away?.papg || 'N/A'}</span>
            </div>
          </div>
          <div class="stat">
            <div class="stat-label">Win %</div>
            <div class="stat-value">
              <span class="stat-home">${game.stats?.home?.winRate || 'N/A'}</span>
              <span class="stat-away">${game.stats?.away?.winRate || 'N/A'}</span>
            </div>
          </div>
          ${game.scores ? `
            <div class="stat">
              <div class="stat-label">Last Match</div>
              <div class="stat-value">
                <span class="stat-home">${game.scores.home}</span>
                <span class="stat-away">${game.scores.away}</span>
              </div>
            </div>
          ` : ''}
        </div>
        ${game.quarterScores ? `
          <div class="quarter-scores">
            ${game.quarterScores.map((score, i) => `
              <div class="quarter-score">Q${i+1}: ${score.home}-${score.away}</div>
            `).join('')}
          </div>
        ` : ''}
      `;
    }
    
    // Helper functions
    function getFormClass(result) {
      if (result === 'W') return 'W';
      if (result === 'D') return 'D';
      if (result === 'L') return 'L';
      return '';
    }
    
    function getConfidenceColor(confidence) {
      if (confidence >= 70) return '#00ff00';
      if (confidence >= 50) return '#ffaa00';
      return '#ff4444';
    }
    
    function calculateProbability(odds) {
      return (100 / parseFloat(odds)).toFixed(1);
    }
    
    function getDefaultAnalysis(game) {
      return {
        recommendation: "Double Chance: Home/Draw",
        confidence: 65,
        advice: "Based on recent form and home advantage, the home team should avoid defeat.",
        probabilities: { home: 45, draw: 25, away: 30 }
      };
    }
    
    function getDefaultStats() {
      return {
        goalsScored: "1.5",
        goalsConceded: "1.2",
        winRate: 40,
        cleanSheets: 30,
        bttsRate: 60
      };
    }
    
    // Auto-refresh every 2 minutes
    setInterval(() => {
      const now = new Date();
      if (now.getMinutes() % 2 === 0 && now.getSeconds() === 0) {
        console.log('Auto-refreshing data...');
        loadGames();
      }
    }, 60000);
    
    // Initialize
    window.onload = loadGames;
    document.getElementById('stakeAmount').addEventListener('input', updatePotentialWin);
  </script>
</body>
</html>
